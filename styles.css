* { box-sizing: border-box; margin: 0; padding: 0; }
        
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", Roboto, "Helvetica Neue", Arial, sans-serif;
    line-height: 1.6;
    background: #f4f7f9;
    padding: 20px;
}

#app-container {
    max-width: 1400px;
    margin: 0 auto;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.1);
    overflow: hidden;
}

.app-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px 40px;
    text-align: center;
    position: relative;
}

.app-header h1 {
    font-size: 2em;
    font-weight: 700;
    margin-bottom: 8px;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.app-header .version {
    font-size: 0.9em;
    opacity: 0.9;
}

.progress-steps {
    display: flex;
    justify-content: space-between;
    padding: 30px 40px;
    background: #f8f9fa;
    border-bottom: 1px solid #e0e0e0;
}

.step {
    flex: 1;
    text-align: center;
    position: relative;
    padding: 0 10px;
}

.step:not(:last-child)::after {
    content: '';
    position: absolute;
    top: 20px;
    right: -50%;
    width: 100%;
    height: 2px;
    background: #ddd;
    z-index: 0;
    transition: background 0.4s;
}

.step.active:not(:last-child)::after,
.step.completed:not(:last-child)::after {
    background: #667eea;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #ddd;
    color: #999;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    margin-bottom: 8px;
    position: relative;
    z-index: 1;
    transition: all 0.3s;
}

.step.active .step-number {
    background: #667eea;
    color: white;
    transform: scale(1.1);
    box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
}

.step.completed .step-number {
    background: #28a745;
    color: white;
}

.step-label {
    font-size: 0.85em;
    color: #666;
    font-weight: 500;
}

.step.active .step-label {
    color: #667eea;
    font-weight: 600;
}

.app-content { padding: 40px; }

.section {
    margin-bottom: 40px;
    animation: fadeIn 0.5s;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.section-title {
    font-size: 1.4em;
    color: #333;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 3px solid #667eea;
    display: inline-block;
}

#drop-area {
    border: 3px dashed #667eea;
    border-radius: 12px;
    padding: 60px 40px;
    text-align: center;
    background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
}

#drop-area::before {
    content: 'üìÅ';
    font-size: 4em;
    display: block;
    margin-bottom: 15px;
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

#drop-area:hover {
    background: linear-gradient(135deg, #e8ebff 0%, #dce0ff 100%);
    border-color: #5568d3;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
}

#drop-area.drag-over {
    background: linear-gradient(135deg, #d0d8ff 0%, #c0cbff 100%);
    border-color: #4050bf;
    transform: scale(1.02);
}

.drop-text { font-size: 1.2em; color: #667eea; font-weight: 600; margin-bottom: 10px; }
.drop-hint { color: #888; font-size: 0.9em; }
#file-input { display: none; }

.file-list-details { margin-top: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e0e0e0; transition: all 0.3s ease-in-out; }
.file-list-summary { padding: 15px 20px; font-weight: 600; color: #667eea; cursor: pointer; list-style: none; display: flex; align-items: center; justify-content: space-between; }
.file-list-summary::-webkit-details-marker { display: none; }
.file-list-summary::after { content: '+'; font-size: 1.8em; font-weight: bold; transition: transform 0.3s ease; line-height: 1; }
.file-list-details[open] > .file-list-summary::after { content: '‚àí'; transform: rotate(180deg); }
.file-list { padding: 0 20px 15px 20px; border-top: 1px solid #e0e0e0; }
.file-item { display: flex; align-items: center; padding: 10px 0; border-bottom: 1px solid #e9ecef; }
.file-item:last-child { border-bottom: none; }
.file-item::before { content: 'üìÑ'; margin-right: 12px; font-size: 1.2em; }
.file-item span { flex: 1; color: #555; font-size: 0.9em; }

#preview-area { background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; max-height: 450px; overflow: auto; }

#preview-area table {
    border-collapse: collapse;
    background: white;
    font-size: 0.85em;
}
#preview-area th, #preview-area td { border: 1px solid #ddd; padding: 8px 12px; text-align: left; }
#preview-area thead th { background: #667eea; color: white; position: sticky; top: 0; z-index: 10; font-weight: 600; }

.form-row { display: flex; gap: 20px; margin-bottom: 20px; align-items: flex-end; flex-wrap: wrap; }
.form-group { flex: 1; min-width: 200px; }
.form-label { display: block; font-weight: 600; color: #555; margin-bottom: 8px; font-size: 0.9em; }
input[type="text"], input[type="number"], select { width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em; transition: all 0.3s; background: white; }
input[type="text"]:focus, input[type="number"]:focus, select:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }

.btn { padding: 12px 30px; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.3s; display: inline-flex; align-items: center; gap: 8px; }
.btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); }
.btn-primary:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5); }
.btn-success { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4); }
.btn-success:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(40, 167, 69, 0.5); }
.btn-info { background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; box-shadow: 0 4px 15px rgba(23, 162, 184, 0.4); }
.btn-info:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(23, 162, 184, 0.5); }
.btn-warning { background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%); color: #212529; box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4); }
.btn-warning:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 193, 7, 0.5); }

.btn:disabled { background: #ccc; cursor: not-allowed; box-shadow: none; transform: none; }
.btn::before { content: attr(data-icon); font-size: 1.2em; }

.mapping-table-wrapper { background: #f8f9fa; border-radius: 8px; padding: 20px; overflow-x: auto; }
.mapping-table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
.mapping-table thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
.mapping-table th { padding: 15px; text-align: left; font-weight: 600; font-size: 0.9em; }
.mapping-table td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; }
.mapping-table tr:hover { background: #f8f9ff; }
.mapping-table input[type="text"], .mapping-table select { padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; }
.mapping-table input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; accent-color: #667eea; }
.excel-col { font-family: 'Courier New', monospace; font-weight: 700; color: #667eea; font-size: 1.1em; }

.output-section { display: none; animation: fadeIn 0.5s; }
.view-tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #e0e0e0; }
.tab-btn { padding: 12px 24px; border: none; background: transparent; color: #666; font-size: 1em; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s; margin-bottom: -2px; }
.tab-btn:hover { color: #667eea; background: #f8f9ff; }
.tab-btn.active { color: #667eea; border-bottom-color: #667eea; background: #f8f9ff; }

.view-pane { display: none; animation: fadeIn 0.3s; }
.view-pane.active { display: block; }

.report-table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; }
.report-table thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
.report-table th { padding: 15px; text-align: left; font-weight: 600; }
.report-table td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; }
.report-table tbody tr:hover { background: #f8f9ff; }
.report-table td.number { text-align: right; font-family: 'Courier New', monospace; font-weight: 600; color: #667eea; }
.report-table .total-row { background: #fff3cd !important; font-weight: 700; }
.report-table .total-row td { border-top: 2px solid #ffc107; }

.alert { padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }
.alert-info { background: #d1ecf1; border-left: 4px solid #17a2b8; color: #0c5460; }
.alert-success { background: #d4edda; border-left: 4px solid #28a745; color: #155724; }
.alert-warning { background: #fff3cd; border-left: 4px solid #ffc107; color: #664d03; }

.alert::before { content: '‚ÑπÔ∏è'; font-size: 1.5em; }
.alert-success::before { content: '‚úÖ'; }
.alert-warning::before { content: '‚ö†Ô∏è'; }

.empty-state { text-align: center; padding: 60px 20px; color: #999; }
.empty-state::before { content: 'üìä'; font-size: 4em; display: block; margin-bottom: 15px; opacity: 0.5; }

.query-select { width: 100%; max-width: 500px; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1em; margin-bottom: 20px; background: white; cursor: pointer; }

.export-controls { display: flex; gap: 10px; }
.btn-outline { background: transparent; border: 2px solid #667eea; color: #667eea; box-shadow: none; padding: 8px 16px; }
.btn-outline:hover:not(:disabled) { background: #f8f9ff; color: #5568d3; border-color: #5568d3; transform: none; box-shadow: none; }

.btn-danger-outline { background: transparent; border: 2px solid #dc3545; color: #dc3545; box-shadow: none; padding: 8px 16px; }
.btn-danger-outline:hover { background: #fff5f5; color: #bd2130; border-color: #bd2130; }

.template-actions { display: flex; gap: 10px; margin-top: 10px; }

@media (max-width: 768px) {
    .app-content { padding: 20px; }
    .progress-steps { flex-wrap: wrap; }
    .step { flex-basis: 50%; margin-bottom: 20px; }
    .form-row { flex-direction: column; }
    .export-controls { flex-wrap: wrap; width: 100%; margin-top: 15px; }
    .template-actions { flex-direction: column; }
}
